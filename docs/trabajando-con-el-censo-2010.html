<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Trabajando con el censo 2010 | Herramientas de análisis espacial en R</title>
  <meta name="description" content="Usando R para analizar datos espaciales" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Trabajando con el censo 2010 | Herramientas de análisis espacial en R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Usando R para analizar datos espaciales" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Trabajando con el censo 2010 | Herramientas de análisis espacial en R" />
  
  <meta name="twitter:description" content="Usando R para analizar datos espaciales" />
  

<meta name="author" content="Martin Montane" />


<meta name="date" content="2020-07-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mapas.html"/>
<link rel="next" href="haciendo-visualizaciones.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3.9000/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3.9000/leaflet-providers-plugin.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Herramientas de análisis espacial en R</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#qué-necesitamos-para-arrancar"><i class="fa fa-check"></i>¿Qué necesitamos para arrancar?</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="datos-espaciales-en-r.html"><a href="datos-espaciales-en-r.html"><i class="fa fa-check"></i><b>1</b> Datos espaciales en R</a><ul>
<li class="chapter" data-level="1.1" data-path="datos-espaciales-en-r.html"><a href="datos-espaciales-en-r.html#qué-es-un-dato-espacial"><i class="fa fa-check"></i><b>1.1</b> ¿Qué es un dato espacial?</a></li>
<li class="chapter" data-level="1.2" data-path="datos-espaciales-en-r.html"><a href="datos-espaciales-en-r.html#dónde-estamos-en-la-tierra"><i class="fa fa-check"></i><b>1.2</b> ¿Dónde estamos en la Tierra?</a></li>
<li class="chapter" data-level="1.3" data-path="datos-espaciales-en-r.html"><a href="datos-espaciales-en-r.html#coordinate-reference-systems"><i class="fa fa-check"></i><b>1.3</b> Coordinate Reference Systems</a><ul>
<li class="chapter" data-level="1.3.1" data-path="datos-espaciales-en-r.html"><a href="datos-espaciales-en-r.html#elipsoides-sistemas-de-coordenadas-y-datums"><i class="fa fa-check"></i><b>1.3.1</b> Elipsoides, sistemas de coordenadas y datums</a></li>
<li class="chapter" data-level="1.3.2" data-path="datos-espaciales-en-r.html"><a href="datos-espaciales-en-r.html#proyecciones"><i class="fa fa-check"></i><b>1.3.2</b> Proyecciones</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="datos-espaciales-en-r.html"><a href="datos-espaciales-en-r.html#manos-a-la-obra-dónde-construir-el-próximo-centro-de-salud"><i class="fa fa-check"></i><b>1.4</b> Manos a la obra ¿Dónde construir el próximo centro de salud?</a><ul>
<li class="chapter" data-level="1.4.1" data-path="datos-espaciales-en-r.html"><a href="datos-espaciales-en-r.html#cargando-los-datos-espaciales"><i class="fa fa-check"></i><b>1.4.1</b> Cargando los datos espaciales</a></li>
<li class="chapter" data-level="1.4.2" data-path="datos-espaciales-en-r.html"><a href="datos-espaciales-en-r.html#detectando-la-cobertura-actual."><i class="fa fa-check"></i><b>1.4.2</b> Detectando la cobertura actual.</a></li>
<li class="chapter" data-level="1.4.3" data-path="datos-espaciales-en-r.html"><a href="datos-espaciales-en-r.html#distancia-contra-la-avenida-más-cercana"><i class="fa fa-check"></i><b>1.4.3</b> Distancia contra la avenida más cercana</a></li>
<li class="chapter" data-level="1.4.4" data-path="datos-espaciales-en-r.html"><a href="datos-espaciales-en-r.html#incorporando-el-resto-de-las-variables"><i class="fa fa-check"></i><b>1.4.4</b> Incorporando el resto de las variables</a></li>
<li class="chapter" data-level="1.4.5" data-path="datos-espaciales-en-r.html"><a href="datos-espaciales-en-r.html#creando-nuestro-índice-de-demanda-de-salud"><i class="fa fa-check"></i><b>1.4.5</b> Creando nuestro índice de demanda de salud</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="datos-espaciales-en-r.html"><a href="datos-espaciales-en-r.html#ejercicio"><i class="fa fa-check"></i><b>1.5</b> Ejercicio</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html"><a href="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html"><i class="fa fa-check"></i><b>2</b> Geocoding: de la representación humana al sistema de coordenadas</a><ul>
<li class="chapter" data-level="2.1" data-path="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html"><a href="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html#qué-es-la-geocodificación-o-geocoding"><i class="fa fa-check"></i><b>2.1</b> ¿Qué es la geocodificación o geocoding?</a></li>
<li class="chapter" data-level="2.2" data-path="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html"><a href="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html#api-interfaz-de-programación-de-aplicaciones"><i class="fa fa-check"></i><b>2.2</b> API: Interfaz de programación de aplicaciones</a></li>
<li class="chapter" data-level="2.3" data-path="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html"><a href="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html#servicio-de-normalización-de-datos-geográficos-de-argentina"><i class="fa fa-check"></i><b>2.3</b> Servicio de Normalización de Datos Geográficos de Argentina</a></li>
<li class="chapter" data-level="2.4" data-path="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html"><a href="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html#google-geocode-api"><i class="fa fa-check"></i><b>2.4</b> Google geocode API</a></li>
<li class="chapter" data-level="2.5" data-path="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html"><a href="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html#diferencias-entre-las-dos-apis"><i class="fa fa-check"></i><b>2.5</b> Diferencias entre las dos APIs</a></li>
<li class="chapter" data-level="2.6" data-path="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html"><a href="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html#una-tercera-alternativa-herer"><i class="fa fa-check"></i><b>2.6</b> Una tercera alternativa: hereR</a></li>
<li class="chapter" data-level="2.7" data-path="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html"><a href="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html#comparando-todos-los-métodos"><i class="fa fa-check"></i><b>2.7</b> Comparando todos los métodos</a></li>
<li class="chapter" data-level="2.8" data-path="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html"><a href="geocoding-de-la-representación-humana-al-sistema-de-coordenadas.html#ejercicios"><i class="fa fa-check"></i><b>2.8</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tiempos-de-viaje-y-análisis-de-accesibilidad.html"><a href="tiempos-de-viaje-y-análisis-de-accesibilidad.html"><i class="fa fa-check"></i><b>3</b> Tiempos de viaje y análisis de accesibilidad</a><ul>
<li class="chapter" data-level="3.1" data-path="tiempos-de-viaje-y-análisis-de-accesibilidad.html"><a href="tiempos-de-viaje-y-análisis-de-accesibilidad.html#la-distancia-espacial-y-la-distancia-de-viaje"><i class="fa fa-check"></i><b>3.1</b> La distancia espacial y la distancia de viaje</a></li>
<li class="chapter" data-level="3.2" data-path="tiempos-de-viaje-y-análisis-de-accesibilidad.html"><a href="tiempos-de-viaje-y-análisis-de-accesibilidad.html#los-paquetes-que-vamos-a-utilizar"><i class="fa fa-check"></i><b>3.2</b> Los paquetes que vamos a utilizar</a><ul>
<li class="chapter" data-level="3.2.1" data-path="tiempos-de-viaje-y-análisis-de-accesibilidad.html"><a href="tiempos-de-viaje-y-análisis-de-accesibilidad.html#cómo-usar-los-servicios-de-here"><i class="fa fa-check"></i><b>3.2.1</b> Cómo usar los servicios de HERE</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="tiempos-de-viaje-y-análisis-de-accesibilidad.html"><a href="tiempos-de-viaje-y-análisis-de-accesibilidad.html#los-datos-repositorio-de-datos-del-gcba"><i class="fa fa-check"></i><b>3.3</b> Los datos: repositorio de datos del GCBA</a></li>
<li class="chapter" data-level="3.4" data-path="tiempos-de-viaje-y-análisis-de-accesibilidad.html"><a href="tiempos-de-viaje-y-análisis-de-accesibilidad.html#transformando-nuestros-datos"><i class="fa fa-check"></i><b>3.4</b> Transformando nuestros datos</a></li>
<li class="chapter" data-level="3.5" data-path="tiempos-de-viaje-y-análisis-de-accesibilidad.html"><a href="tiempos-de-viaje-y-análisis-de-accesibilidad.html#cuánto-tardo-en-llegar-al-monumental"><i class="fa fa-check"></i><b>3.5</b> ¿Cuánto tardo en llegar al monumental?</a></li>
<li class="chapter" data-level="3.6" data-path="tiempos-de-viaje-y-análisis-de-accesibilidad.html"><a href="tiempos-de-viaje-y-análisis-de-accesibilidad.html#midiendo-la-cobertura-de-los-parques"><i class="fa fa-check"></i><b>3.6</b> Midiendo la cobertura de los parques</a></li>
<li class="chapter" data-level="3.7" data-path="tiempos-de-viaje-y-análisis-de-accesibilidad.html"><a href="tiempos-de-viaje-y-análisis-de-accesibilidad.html#redondeando-caracterizando-la-oferta-de-los-espacios-verdes-en-caba"><i class="fa fa-check"></i><b>3.7</b> Redondeando: caracterizando la oferta de los espacios verdes en CABA</a></li>
<li class="chapter" data-level="3.8" data-path="tiempos-de-viaje-y-análisis-de-accesibilidad.html"><a href="tiempos-de-viaje-y-análisis-de-accesibilidad.html#ejercicios-1"><i class="fa fa-check"></i><b>3.8</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="el-ritual-del-aprendizaje-automático-parte-1.html"><a href="el-ritual-del-aprendizaje-automático-parte-1.html"><i class="fa fa-check"></i><b>4</b> El ritual del aprendizaje automático (Parte 1)</a><ul>
<li class="chapter" data-level="4.1" data-path="el-ritual-del-aprendizaje-automático-parte-1.html"><a href="el-ritual-del-aprendizaje-automático-parte-1.html#paso-1-carga-de-los-datos"><i class="fa fa-check"></i><b>4.1</b> Paso 1: Carga de los datos</a></li>
<li class="chapter" data-level="4.2" data-path="el-ritual-del-aprendizaje-automático-parte-1.html"><a href="el-ritual-del-aprendizaje-automático-parte-1.html#paso-2-análisis-exploratorio-y-corrección-de-errores"><i class="fa fa-check"></i><b>4.2</b> Paso 2: análisis exploratorio y corrección de errores</a></li>
<li class="chapter" data-level="4.3" data-path="el-ritual-del-aprendizaje-automático-parte-1.html"><a href="el-ritual-del-aprendizaje-automático-parte-1.html#paso-3-crear-nuevas-variables-o-feature-engineering"><i class="fa fa-check"></i><b>4.3</b> Paso 3: crear nuevas variables (o <em>feature engineering</em>)</a></li>
<li class="chapter" data-level="4.4" data-path="el-ritual-del-aprendizaje-automático-parte-1.html"><a href="el-ritual-del-aprendizaje-automático-parte-1.html#paso-4-criterio-de-selección-y-optimización-de-los-parámetros"><i class="fa fa-check"></i><b>4.4</b> Paso 4: criterio de selección y optimización de los parámetros</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="el-ritual-del-aprendizaje-automático-parte-2.html"><a href="el-ritual-del-aprendizaje-automático-parte-2.html"><i class="fa fa-check"></i><b>5</b> El ritual del aprendizaje automático (Parte 2)</a><ul>
<li class="chapter" data-level="5.1" data-path="el-ritual-del-aprendizaje-automático-parte-2.html"><a href="el-ritual-del-aprendizaje-automático-parte-2.html#separando-dataset-de-entrenamiento-y-de-testing"><i class="fa fa-check"></i><b>5.1</b> Separando dataset de entrenamiento y de testing</a></li>
<li class="chapter" data-level="5.2" data-path="el-ritual-del-aprendizaje-automático-parte-2.html"><a href="el-ritual-del-aprendizaje-automático-parte-2.html#nuestra-receta-y-su-preparación"><i class="fa fa-check"></i><b>5.2</b> Nuestra receta y su preparación</a></li>
<li class="chapter" data-level="5.3" data-path="el-ritual-del-aprendizaje-automático-parte-2.html"><a href="el-ritual-del-aprendizaje-automático-parte-2.html#selección-de-modelo-y-espacio-de-búsqueda-de-los-parámetros"><i class="fa fa-check"></i><b>5.3</b> Selección de modelo y espacio de búsqueda de los parámetros</a></li>
<li class="chapter" data-level="5.4" data-path="el-ritual-del-aprendizaje-automático-parte-2.html"><a href="el-ritual-del-aprendizaje-automático-parte-2.html#entrenando-los-modelos-en-nuestro-espacio-de-búsqueda"><i class="fa fa-check"></i><b>5.4</b> Entrenando los modelos en nuestro espacio de búsqueda</a></li>
<li class="chapter" data-level="5.5" data-path="el-ritual-del-aprendizaje-automático-parte-2.html"><a href="el-ritual-del-aprendizaje-automático-parte-2.html#seleccionando-el-mejor-modelo-y-analizando-los-resultados"><i class="fa fa-check"></i><b>5.5</b> Seleccionando el mejor modelo y analizando los resultados</a></li>
<li class="chapter" data-level="5.6" data-path="el-ritual-del-aprendizaje-automático-parte-2.html"><a href="el-ritual-del-aprendizaje-automático-parte-2.html#importancia-de-las-variables"><i class="fa fa-check"></i><b>5.6</b> Importancia de las variables</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mapas.html"><a href="mapas.html"><i class="fa fa-check"></i><b>6</b> Mapas</a></li>
<li class="chapter" data-level="7" data-path="trabajando-con-el-censo-2010.html"><a href="trabajando-con-el-censo-2010.html"><i class="fa fa-check"></i><b>7</b> Trabajando con el censo 2010</a><ul>
<li class="chapter" data-level="7.1" data-path="trabajando-con-el-censo-2010.html"><a href="trabajando-con-el-censo-2010.html#datos-del-censo-2010"><i class="fa fa-check"></i><b>7.1</b> Datos del censo 2010</a></li>
<li class="chapter" data-level="7.2" data-path="trabajando-con-el-censo-2010.html"><a href="trabajando-con-el-censo-2010.html#polígonos-del-censo-2010"><i class="fa fa-check"></i><b>7.2</b> Polígonos del Censo 2010</a></li>
<li class="chapter" data-level="7.3" data-path="trabajando-con-el-censo-2010.html"><a href="trabajando-con-el-censo-2010.html#uniendo-los-datos-con-sus-polígonos"><i class="fa fa-check"></i><b>7.3</b> Uniendo los datos con sus polígonos</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="haciendo-visualizaciones.html"><a href="haciendo-visualizaciones.html"><i class="fa fa-check"></i><b>8</b> Haciendo visualizaciones</a><ul>
<li class="chapter" data-level="8.1" data-path="haciendo-visualizaciones.html"><a href="haciendo-visualizaciones.html#ggplot2"><i class="fa fa-check"></i><b>8.1</b> Ggplot2</a></li>
<li class="chapter" data-level="8.2" data-path="haciendo-visualizaciones.html"><a href="haciendo-visualizaciones.html#tmap"><i class="fa fa-check"></i><b>8.2</b> Tmap</a></li>
<li class="chapter" data-level="8.3" data-path="haciendo-visualizaciones.html"><a href="haciendo-visualizaciones.html#leaflet"><i class="fa fa-check"></i><b>8.3</b> Leaflet</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ejercicios-2.html"><a href="ejercicios-2.html"><i class="fa fa-check"></i><b>9</b> Ejercicios</a></li>
<li class="chapter" data-level="10" data-path="making-polygons-comparable-again.html"><a href="making-polygons-comparable-again.html"><i class="fa fa-check"></i><b>10</b> Making polygons comparable again</a><ul>
<li class="chapter" data-level="10.1" data-path="making-polygons-comparable-again.html"><a href="making-polygons-comparable-again.html#carga-de-los-datos"><i class="fa fa-check"></i><b>10.1</b> Carga de los datos</a></li>
<li class="chapter" data-level="10.2" data-path="making-polygons-comparable-again.html"><a href="making-polygons-comparable-again.html#diferentes-radios-censales"><i class="fa fa-check"></i><b>10.2</b> Diferentes radios censales</a><ul>
<li class="chapter" data-level="10.2.1" data-path="making-polygons-comparable-again.html"><a href="making-polygons-comparable-again.html#breve-desvío-haciendo-lo-mismo-con-ggplot"><i class="fa fa-check"></i><b>10.2.1</b> Breve desvío: haciendo lo mismo con ggplot()</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="making-polygons-comparable-again.html"><a href="making-polygons-comparable-again.html#make-polygons-comparable-again"><i class="fa fa-check"></i><b>10.3</b> Make polygons comparable again</a></li>
<li class="chapter" data-level="10.4" data-path="making-polygons-comparable-again.html"><a href="making-polygons-comparable-again.html#haciendo-mapas-de-nuestros-nuevos-datos"><i class="fa fa-check"></i><b>10.4</b> Haciendo mapas de nuestros nuevos datos</a></li>
<li class="chapter" data-level="10.5" data-path="making-polygons-comparable-again.html"><a href="making-polygons-comparable-again.html#ejercicio-1"><i class="fa fa-check"></i><b>10.5</b> Ejercicio</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Herramientas de análisis espacial en R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="trabajando-con-el-censo-2010" class="section level1">
<h1><span class="header-section-number">7</span> Trabajando con el censo 2010</h1>
<div id="datos-del-censo-2010" class="section level2">
<h2><span class="header-section-number">7.1</span> Datos del censo 2010</h2>
<p>Hasta ahora hemos hecho énfasis en el dataset de propiedades de Properati en CABA. Vamos a retomar ese tema un poco más adelante, pero para volver a entrenar las fases anteriores del proceso de data science (importar, transformar y graficar datos) vamos a utilizar los datos del Censo 2010, provistos por <a href="http://datar.noip.me/" class="uri">http://datar.noip.me/</a>. Debido a que el archivo .rar pesa 400mb - y que varias de las actividades que vamos a hacer probablemente no puedan ejecutarse en todas las computadores del curso, por un tema de memoria RAM - lo que hice fue, al igual que la clase 2, tomar una muestra estratificada del censo de tal manera que puedan recorrer todo el camino.</p>
<p>El archivo con la muestra estratificada pueden descargarlo desde nuestro repositorio. Para replicar la experiencia que tendrían si descargaran los datos del censo desde <a href="http://datar.noip.me/" class="uri">http://datar.noip.me/</a>, se trata de un .rar cuyo contenido deberían extraer en la carpeta del proyecto (o alguna subcarpeta). Hay ocho archivos .csv, que eventualmente usaremos, y un archivo descripción.txt, donde tenemos la información sobre qué es cada variable y cuales son los valores que pueden tomar. Además, existe una carpeta que se llama “labels”, donde se encuentra la información sobre qué significa cada uno de los valores de las variables para un subconjunto de ellas. De cualquier manera, no lo vamos a usar ya que esa información se encuentra en el archivo .txt.</p>
<p>Pueden acceder al archivo .rar que contiene todos estos archivos desde <a href="https://github.com/datalab-UTDT/datasets/raw/master/CNPHyV-2010Sample.rar" class="uri">https://github.com/datalab-UTDT/datasets/raw/master/CNPHyV-2010Sample.rar</a>. Recuerden que deben descargarlo en alguna de las carpetas dentro de sus proyectos.</p>
<p>El censo del 2010 en Argentina distingue entre las siguientes tres entidades principales:</p>
<ol style="list-style-type: decimal">
<li><strong>Viviendas</strong>. Según el INDEC, una vivienda es “un espacio donde viven personas”. En realidad, un lugar donde podrían vivir personas, pero al momento del censo pueden estar ocupados o desocupadas.</li>
<li><strong>Hogares</strong>. Un hogar para el INDEC es una persona o grupo de personas que viven 1) bajo el mismo techo y 2) comparten los gastos de alimentación.</li>
<li><strong>Individuos</strong></li>
</ol>
<p>Los datos vinculados a cada una de estas unidades están almacenadas en diversos archivos .csv: “VIVIENDA.csv”, “HOGAR.csv” y “PERSONA.csv”. Comencemos primero con las viviendas:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="trabajando-con-el-censo-2010.html#cb207-1"></a>viviendas &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="dt">file =</span> <span class="st">&#39;data/CNPHyV-2010Sample/VIVIENDA.csv&#39;</span>,<span class="dt">delim=</span><span class="st">&quot;;&quot;</span>)</span></code></pre></div>
<p>Estén atentos que estamos usando la función <strong>read_delim</strong> en lugar de <strong>read_csv</strong>. La principal diferencia es que con read_delim() podemos indicar con el argumento <em>delim</em> el caracter que marca la separación entre datos</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="trabajando-con-el-censo-2010.html#cb208-1"></a><span class="kw">glimpse</span>(viviendas)</span></code></pre></div>
<pre><code>## Rows: 52,508
## Columns: 13
## $ VIVIENDA_REF_ID &lt;dbl&gt; 17831, 32505, 99783, 8879, 78302, 12649, 87383, 50584, 4089, 4494, 91055, 58043, 131148, 108284, 23444,...
## $ RADIO_REF_ID    &lt;dbl&gt; 61, 88, 236, 45, 181, 51, 204, 121, 27, 29, 214, 133, 329, 259, 72, 221, 66, 264, 121, 117, 285, 122, 3...
## $ TIPVV           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ V01             &lt;dbl&gt; 4, 4, 1, 4, 4, 4, 4, 4, 1, 1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1...
## $ V02             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ V00             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
## $ URP             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ INCALSERV       &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3...
## $ INMAT           &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 1, 1, 2, 2, 3, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 2...
## $ MUNI            &lt;dbl&gt; 20010001, 20010001, 20010001, 20010001, 20010001, 20010001, 20010001, 20010001, 20010001, 20010001, 200...
## $ LOCAL           &lt;dbl&gt; 2001010, 2001010, 2001010, 2001010, 2001010, 2001010, 2001010, 2001010, 2001010, 2001010, 2001010, 2001...
## $ INCALCONS       &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 1, 1, 2, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 2...
## $ TOTHOG          &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...</code></pre>
<p>Son 52.508 viviendas, con 13 variables. Varias de ellas nos dan información sobre la ubicación geógrafica. Por ejemplo, <strong>RADIO_REF_ID</strong> es una variable que vincula a cada vivienda con un determinado <strong>radio censal</strong>, la unidad geográfica de menor tamaño del censo. La muestra con la que estamos trabajando está estratificada a nivel de <strong>departamentos</strong>, por lo que pueden existir radios censales para los cuales no exista ninguna información. <strong>VIVIENDA_REF_ID</strong> identifica de manera única a las viviendas, y será de mucha utilidad más tarde para usar información sobre los hogares y los invididuos.</p>
<p>Con respecto a los datos específicos sobre las viviendas, dos de los más interesantes son <strong>INCALSERV</strong>, e <strong>INCALCONS</strong> que nos indican el índice de calidad de conexiones a servicios públicos y el índice de calidad de la construcción de la vivienda, respectivamente. La página Redatam (<a href="https://redatam.indec.gob.ar/argbin/RpWebEngine.exe/PortalAction?&amp;MODE=MAIN&amp;BASE=CPV2010B&amp;MAIN=WebServerMain.inl" class="uri">https://redatam.indec.gob.ar/argbin/RpWebEngine.exe/PortalAction?&amp;MODE=MAIN&amp;BASE=CPV2010B&amp;MAIN=WebServerMain.inl</a>) del Censo 2010 de Argentina nos permite ver cuáles son todas las variables del “cuestionario básico” y las variables que pueden tomar. En este caso, ambas variables pueden tomar los valores 1,2 o 3 (“Satisfactoria”, “Básica” e “Insuficiente”).</p>
<p>Dejemos por un lado las variables referidas a los índices de calidad. Recuerden que estamos trabajando con una muestra estratificada a nivel departamental, por lo que nuestros gráficos tendrán más sentido a esa agregación o mayor (nivel provincial). Lamentablemente, nuestro dataset de viviendas no nos dice a cuál departamento pertenece cada vivienda, pero, como anticipamos anteriormente, sí nos da información sobre su radio censal en <strong>RADIO_REF_ID</strong>. Los radios censales se agrupan en <strong>fracciones censales</strong>, que a su vez se asocian a departamentos y estos últimos a las provincias. Como les dije, hoy vamos a leer muchos archivos para prácticar ¡Allá vamos!</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="trabajando-con-el-censo-2010.html#cb210-1"></a>radios &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="dt">file =</span> <span class="st">&#39;data/CNPHyV-2010Sample/RADIO.csv&#39;</span>, <span class="dt">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb210-2"><a href="trabajando-con-el-censo-2010.html#cb210-2"></a>fracciones &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="dt">file =</span> <span class="st">&quot;data/CNPHyV-2010Sample/FRAC.csv&quot;</span>, <span class="dt">delim=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb210-3"><a href="trabajando-con-el-censo-2010.html#cb210-3"></a><span class="co"># El parámetro LOCALE nos permite especificar algunas caracteristicas sobre cómo leer los datos, en este caso pedimos que el encoding sea UTF-8. Además, usamos trimws() para sacar alguno de los espacios que tiene la columna NOMDPTO</span></span>
<span id="cb210-4"><a href="trabajando-con-el-censo-2010.html#cb210-4"></a>departamentos &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="dt">file =</span> <span class="st">&quot;data/CNPHyV-2010Sample/DPTO.csv&quot;</span>, <span class="dt">delim=</span><span class="st">&quot;;&quot;</span>,<span class="dt">locale =</span> <span class="kw">locale</span>(<span class="dt">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb210-5"><a href="trabajando-con-el-censo-2010.html#cb210-5"></a><span class="st">                 </span><span class="kw">mutate</span>(<span class="dt">NOMDPTO=</span><span class="kw">trimws</span>(NOMDPTO))</span></code></pre></div>
<p>Bien, si no tuvieron ningun problemas con los separadores - ni con la dirección del archivo -, ya están en condiciones de observar qué contenido tiene cada uno de nuestros objetos. Veamos:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="trabajando-con-el-censo-2010.html#cb211-1"></a><span class="kw">glimpse</span>(radios)</span></code></pre></div>
<pre><code>## Rows: 52,382
## Columns: 3
## $ RADIO_REF_ID &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29,...
## $ FRAC_REF_ID  &lt;dbl&gt; 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3...
## $ IDRADIO      &lt;chr&gt; &quot;01&quot;, &quot;01&quot;, &quot;02&quot;, &quot;03&quot;, &quot;04&quot;, &quot;05&quot;, &quot;06&quot;, &quot;07&quot;, &quot;08&quot;, &quot;09&quot;, &quot;10&quot;, &quot;11&quot;, &quot;12&quot;, &quot;13&quot;, &quot;14&quot;, &quot;15&quot;, &quot;16&quot;, &quot;17&quot;...</code></pre>
<p><strong>radios</strong> es un Data Frame con 3 variables y 52.382 observaciones. Cada una de las observaciones corresponde a un radio único, por lo que en el Censo 2010 los radios censales fueron levemente superior a 52.000. Como vemos, cada radio censal se asocia a una única fracción censal. Veamos ahora nuestro data frame que contiene información sobre las fracciones.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="trabajando-con-el-censo-2010.html#cb213-1"></a><span class="kw">glimpse</span>(fracciones)</span></code></pre></div>
<pre><code>## Rows: 5,428
## Columns: 3
## $ FRAC_REF_ID &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, ...
## $ DPTO_REF_ID &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2,...
## $ IDFRAC      &lt;chr&gt; &quot;01&quot;, &quot;02&quot;, &quot;03&quot;, &quot;04&quot;, &quot;05&quot;, &quot;06&quot;, &quot;07&quot;, &quot;08&quot;, &quot;09&quot;, &quot;10&quot;, &quot;11&quot;, &quot;12&quot;, &quot;13&quot;, &quot;14&quot;, &quot;15&quot;, &quot;16&quot;, &quot;17&quot;, &quot;18&quot;,...</code></pre>
<p>Bien, las fracciones censales son 5.428 y cada una de ellas corresponde a un determinado departamento, que podemos a su vez consultar en el data frame homónimo:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="trabajando-con-el-censo-2010.html#cb215-1"></a><span class="kw">glimpse</span>(departamentos)</span></code></pre></div>
<pre><code>## Rows: 527
## Columns: 5
## $ DPTO_REF_ID &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, ...
## $ PROV_REF_ID &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,...
## $ IDDPTO      &lt;chr&gt; &quot;001&quot;, &quot;002&quot;, &quot;003&quot;, &quot;004&quot;, &quot;005&quot;, &quot;006&quot;, &quot;007&quot;, &quot;008&quot;, &quot;009&quot;, &quot;010&quot;, &quot;011&quot;, &quot;012&quot;, &quot;013&quot;, &quot;014&quot;, &quot;015&quot;, &quot;0...
## $ DPTO        &lt;dbl&gt; 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 6028, 6035, 6091,...
## $ NOMDPTO     &lt;chr&gt; &quot;Comuna 01&quot;, &quot;Comuna 02&quot;, &quot;Comuna 03&quot;, &quot;Comuna 04&quot;, &quot;Comuna 05&quot;, &quot;Comuna 06&quot;, &quot;Comuna 07&quot;, &quot;Comuna 08&quot;, &quot;Co...</code></pre>
<p>El data frame departamentos cuenta con más información, ya que también incluye el nombre de los departamentos.</p>
<p>Ya tenemos nuestro camino para unir a las viviendas con sus respectivos departamentos: tenemos que combinar los radios con las fracciones y luego las fracciones con sus departamentos. Por suerte, <strong>tidyverse</strong> nos brinda una función importante para lograr esto: <strong>left_join</strong>. Veamos cómo funciona:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="trabajando-con-el-censo-2010.html#cb217-1"></a>radios &lt;-<span class="st"> </span><span class="kw">left_join</span>(radios, fracciones, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;FRAC_REF_ID&quot;</span>))</span>
<span id="cb217-2"><a href="trabajando-con-el-censo-2010.html#cb217-2"></a><span class="kw">glimpse</span>(radios)</span></code></pre></div>
<pre><code>## Rows: 52,382
## Columns: 5
## $ RADIO_REF_ID &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29,...
## $ FRAC_REF_ID  &lt;dbl&gt; 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3...
## $ IDRADIO      &lt;chr&gt; &quot;01&quot;, &quot;01&quot;, &quot;02&quot;, &quot;03&quot;, &quot;04&quot;, &quot;05&quot;, &quot;06&quot;, &quot;07&quot;, &quot;08&quot;, &quot;09&quot;, &quot;10&quot;, &quot;11&quot;, &quot;12&quot;, &quot;13&quot;, &quot;14&quot;, &quot;15&quot;, &quot;16&quot;, &quot;17&quot;...
## $ DPTO_REF_ID  &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ IDFRAC       &lt;chr&gt; &quot;01&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;...</code></pre>
<p>Si se fijan bien, el data frame <strong>radios</strong> ahora tiene 5 variables: las 3 iniciales y dos nuevas: <strong>DPTO_REF_ID</strong> e <strong>IDFRAC</strong>. La cantidad de filas es la mismas que antes ¿Qué es lo que hace la función <strong>left_join</strong>? Para cada observación del primer data frame que le pasamos (<strong>radios</strong>) incorpora las variables que están en el segundo dataset que le pasamos (<strong>fracciones</strong>) usando una o más columnas que sirven para unir ambos data frames, en este caso <strong>FRAC_REF_ID</strong>.</p>
<p>Uno podria pensar que como ahora tenemos el ID del departamento ya podemos unir a las viviendas con los departamentos. Sin embargo, como vamos a ver más adelante los ids de los departamentos en estas tablas no coinciden con los del shapefile disponible en el mismo repositorio. Por esta razón, vamos a tener que trabajar con los códigos de los departamentos. Para esto, debemos hacer un nuevo left_join entre las fracciones censales y el data frame con el listado de departamentos para obtener el código:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="trabajando-con-el-censo-2010.html#cb219-1"></a>radios &lt;-<span class="st"> </span><span class="kw">left_join</span>(radios, departamentos <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(DPTO_REF_ID, DPTO), <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;DPTO_REF_ID&quot;</span>))</span>
<span id="cb219-2"><a href="trabajando-con-el-censo-2010.html#cb219-2"></a><span class="kw">glimpse</span>(radios)</span></code></pre></div>
<pre><code>## Rows: 52,382
## Columns: 6
## $ RADIO_REF_ID &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29,...
## $ FRAC_REF_ID  &lt;dbl&gt; 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3...
## $ IDRADIO      &lt;chr&gt; &quot;01&quot;, &quot;01&quot;, &quot;02&quot;, &quot;03&quot;, &quot;04&quot;, &quot;05&quot;, &quot;06&quot;, &quot;07&quot;, &quot;08&quot;, &quot;09&quot;, &quot;10&quot;, &quot;11&quot;, &quot;12&quot;, &quot;13&quot;, &quot;14&quot;, &quot;15&quot;, &quot;16&quot;, &quot;17&quot;...
## $ DPTO_REF_ID  &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ IDFRAC       &lt;chr&gt; &quot;01&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;...
## $ DPTO         &lt;dbl&gt; 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001, 2001...</code></pre>
<p>Ya podemos vincular las viviendas a los departamentos, ya que nuestro data frame de viviendas tiene una variable que identifica a cada radio, y nuestro data frame que acabamos de crear contiene el mismo ID y lo asigna al departamento correspondiente. Antes de aplicar el <strong>left_join</strong>, es importante marcar que siempre nos devuelve <strong>todas</strong> las columnas de ambos dataframes. Esto es ineficiente en muchos casos, por ejemplo a nosotros solo nos interesa agregar la información sobre <strong>DPTO</strong> (el código del departamento). La forma más fácil de evitar hacer innecesariamente grande nuestro dataset es eliminar las variables antes de hacer el join:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="trabajando-con-el-censo-2010.html#cb221-1"></a>viviendas &lt;-<span class="st"> </span><span class="kw">left_join</span>(<span class="dt">x =</span> viviendas,</span>
<span id="cb221-2"><a href="trabajando-con-el-censo-2010.html#cb221-2"></a>                       <span class="dt">y =</span> radios <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(RADIO_REF_ID, DPTO),</span>
<span id="cb221-3"><a href="trabajando-con-el-censo-2010.html#cb221-3"></a>                       <span class="dt">by =</span> <span class="st">&quot;RADIO_REF_ID&quot;</span>)</span>
<span id="cb221-4"><a href="trabajando-con-el-censo-2010.html#cb221-4"></a><span class="kw">str</span>(viviendas) <span class="co"># En la 14va columna tenemos el departamento al que pertenece</span></span></code></pre></div>
<pre><code>## tibble [52,508 x 14] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
##  $ VIVIENDA_REF_ID: num [1:52508] 17831 32505 99783 8879 78302 ...
##  $ RADIO_REF_ID   : num [1:52508] 61 88 236 45 181 51 204 121 27 29 ...
##  $ TIPVV          : num [1:52508] 1 1 1 1 1 1 1 1 1 1 ...
##  $ V01            : num [1:52508] 4 4 1 4 4 4 4 4 1 1 ...
##  $ V02            : num [1:52508] 1 1 1 1 1 1 1 1 1 1 ...
##  $ V00            : num [1:52508] 0 0 0 0 0 0 0 0 0 0 ...
##  $ URP            : num [1:52508] 1 1 1 1 1 1 1 1 1 1 ...
##  $ INCALSERV      : num [1:52508] 1 1 1 1 1 1 1 1 1 1 ...
##  $ INMAT          : num [1:52508] 1 1 1 1 1 2 1 1 2 2 ...
##  $ MUNI           : num [1:52508] 2e+07 2e+07 2e+07 2e+07 2e+07 ...
##  $ LOCAL          : num [1:52508] 2e+06 2e+06 2e+06 2e+06 2e+06 ...
##  $ INCALCONS      : num [1:52508] 1 1 1 1 1 2 1 1 2 3 ...
##  $ TOTHOG         : num [1:52508] 1 1 1 1 1 2 1 1 1 1 ...
##  $ DPTO           : num [1:52508] 2001 2001 2001 2001 2001 ...
##  - attr(*, &quot;spec&quot;)=
##   .. cols(
##   ..   VIVIENDA_REF_ID = col_double(),
##   ..   RADIO_REF_ID = col_double(),
##   ..   TIPVV = col_double(),
##   ..   V01 = col_double(),
##   ..   V02 = col_double(),
##   ..   V00 = col_double(),
##   ..   URP = col_double(),
##   ..   INCALSERV = col_double(),
##   ..   INMAT = col_double(),
##   ..   MUNI = col_double(),
##   ..   LOCAL = col_double(),
##   ..   INCALCONS = col_double(),
##   ..   TOTHOG = col_double()
##   .. )</code></pre>
</div>
<div id="polígonos-del-censo-2010" class="section level2">
<h2><span class="header-section-number">7.2</span> Polígonos del Censo 2010</h2>
<p>El caso del censo es uno de los más clásicos cuando queremos cruzar datos que pertenecen a una determinada organización territorial pero que no tienen incluido un <strong>shapefile</strong> o <strong>geojson</strong> (otra forma de guardar datos espaciales). En ese caso debemos encontrar los polígonos de cada región administrativa (departamentos) y unir los polígonos con los datos (joinearlos), del mismo modo que hicimos anteriormente. Pueden <a href="">descargar estos datos desde aquí</a>. Ya saben como leer shapefiles a R con <strong>read_sf()</strong></p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="trabajando-con-el-censo-2010.html#cb223-1"></a>sfDpto &lt;-<span class="st"> </span><span class="kw">read_sf</span>(<span class="st">&quot;data/deptosShapefile/pxdptodatosok.shp&quot;</span>)</span>
<span id="cb223-2"><a href="trabajando-con-el-censo-2010.html#cb223-2"></a><span class="kw">glimpse</span>(sfDpto)</span></code></pre></div>
<pre><code>## Rows: 527
## Columns: 11
## $ link       &lt;chr&gt; &quot;02001&quot;, &quot;02002&quot;, &quot;02003&quot;, &quot;02004&quot;, &quot;06091&quot;, &quot;74056&quot;, &quot;02005&quot;, &quot;02006&quot;, &quot;06147&quot;, &quot;02007&quot;, &quot;02008&quot;, &quot;02009&quot;, ...
## $ codpcia    &lt;chr&gt; &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;06&quot;, &quot;74&quot;, &quot;02&quot;, &quot;02&quot;, &quot;06&quot;, &quot;02&quot;, &quot;02&quot;, &quot;02&quot;, &quot;06&quot;, &quot;02&quot;, &quot;06&quot;, &quot;06&quot;, &quot;02&quot;, &quot;02&quot;, ...
## $ departamen &lt;chr&gt; &quot;Comuna 1&quot;, &quot;Comuna 2&quot;, &quot;Comuna 3&quot;, &quot;Comuna 4&quot;, &quot;Berazategui&quot;, &quot;La Capital&quot;, &quot;Comuna 5&quot;, &quot;Comuna 6&quot;, &quot;Carlos...
## $ provincia  &lt;chr&gt; &quot;Ciudad Autónoma de Buenos Aires&quot;, &quot;Ciudad Autónoma de Buenos Aires&quot;, &quot;Ciudad Autónoma de Buenos Aires&quot;, &quot;Ci...
## $ mujeres    &lt;chr&gt; &quot;107789&quot;, &quot;89890&quot;, &quot;101936&quot;, &quot;115079&quot;, &quot;165636&quot;, &quot;104417&quot;, &quot;98199&quot;, &quot;97206&quot;, &quot;11381&quot;, &quot;118110&quot;, &quot;97692&quot;, &quot;85...
## $ varones    &lt;chr&gt; &quot;98097&quot;, &quot;68042&quot;, &quot;85601&quot;, &quot;103166&quot;, &quot;158608&quot;, &quot;99602&quot;, &quot;80806&quot;, &quot;78870&quot;, &quot;10856&quot;, &quot;102481&quot;, &quot;89545&quot;, &quot;76207...
## $ personas   &lt;chr&gt; &quot;205886&quot;, &quot;157932&quot;, &quot;187537&quot;, &quot;218245&quot;, &quot;324244&quot;, &quot;204019&quot;, &quot;179005&quot;, &quot;176076&quot;, &quot;22237&quot;, &quot;220591&quot;, &quot;187237&quot;,...
## $ hogares    &lt;chr&gt; &quot;84468&quot;, &quot;73156&quot;, &quot;80489&quot;, &quot;76455&quot;, &quot;93164&quot;, &quot;58559&quot;, &quot;76846&quot;, &quot;75189&quot;, &quot;7775&quot;, &quot;81483&quot;, &quot;58204&quot;, &quot;56495&quot;, &quot;...
## $ viv_part   &lt;chr&gt; &quot;130771&quot;, &quot;107967&quot;, &quot;101161&quot;, &quot;82926&quot;, &quot;96025&quot;, &quot;62166&quot;, &quot;92750&quot;, &quot;93368&quot;, &quot;9446&quot;, &quot;89520&quot;, &quot;55377&quot;, &quot;63322&quot;...
## $ viv_part_h &lt;chr&gt; &quot;78360&quot;, &quot;70869&quot;, &quot;75605&quot;, &quot;69680&quot;, &quot;86248&quot;, &quot;53317&quot;, &quot;73226&quot;, &quot;72942&quot;, &quot;7504&quot;, &quot;73034&quot;, &quot;48631&quot;, &quot;52355&quot;, &quot;...
## $ geometry   &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((-58.37501 -..., MULTIPOLYGON (((-58.40084 -..., MULTIPOLYGON (((-58.39365 -...,...</code></pre>
<p>Para hacer el join precisamos identificar la variable que tiene a los ids de los departamentos. En este caso podemos ver que la variable <strong>link</strong> (es una variable <strong>factor</strong>) tiene 527 valores (la misma cantidad de departamentos que tiene Argentina) y toma los mismos valores que nuestra variable en el dataset de viviendas (<strong>DPTO</strong>). Sin embargo, están en distinto formato: una es una variable numérica, mientras que la otra es una variable factor. Para hacer el join precisamos que ambas variables tengan el mismo formato:</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="trabajando-con-el-censo-2010.html#cb225-1"></a>sfDpto<span class="op">$</span>link &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(sfDpto<span class="op">$</span>link))</span></code></pre></div>
<p>Como no nos importa ninguna de las otras variables con las que viene el objeto sf, con excepción de su geometría (obviamente) y la varible “link” que contiene la información necesaria para hacer el join, vamos a quedarnos solo con ellas. Usemos lo que ya conocemos:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="trabajando-con-el-censo-2010.html#cb226-1"></a>sfDpto &lt;-<span class="st"> </span>sfDpto <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(link)</span></code></pre></div>
</div>
<div id="uniendo-los-datos-con-sus-polígonos" class="section level2">
<h2><span class="header-section-number">7.3</span> Uniendo los datos con sus polígonos</h2>
<p>Una de las opciones que podrían hacer es unir las observaciones de las viviendas a cada uno de los polígonos que pertenece. Sin embargo, esto no es eficiente. Lo mejor es hacer nuestras transformaciones sobre el dataset de viviendas para luego hacer la unión con los polígonos cuando tengamos un dataset con los indicadores por departamento. Las operaciones de join suelen ocupar mucho espacio de memoria (y tiempo), especialmente cuando se trata de muchas filas y columnas. Además, siempre que se pueda es mejor hacer nuestras transformaciones de datos cuando no son objetos Simple Feature.</p>
<p>Vamos a generar un indicador de “mala infraestructura”. En rigor, vamos a medir la proporción de viviendas que presentan un índice de calidad de servicios igual a 3 (insuficiente) o de calidad de construcción de viviendas igual a 3 (insuficiente). Luego, vamos a agrupar el dataset por los departamentos. Por suerte, ya sabemos como hacerlo con <strong>tidyverse</strong>:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="trabajando-con-el-censo-2010.html#cb227-1"></a>datosCalidad &lt;-<span class="st"> </span>viviendas <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb227-2"><a href="trabajando-con-el-censo-2010.html#cb227-2"></a><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">indiceCalidad =</span> <span class="kw">ifelse</span>(INCALSERV <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">|</span><span class="st"> </span>INCALCONS <span class="op">==</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">%&gt;%</span></span>
<span id="cb227-3"><a href="trabajando-con-el-censo-2010.html#cb227-3"></a><span class="st">                </span><span class="kw">group_by</span>(DPTO) <span class="op">%&gt;%</span></span>
<span id="cb227-4"><a href="trabajando-con-el-censo-2010.html#cb227-4"></a><span class="st">                </span><span class="kw">summarise</span>(<span class="dt">indiceCalidad =</span> <span class="kw">round</span>(<span class="kw">sum</span>(indiceCalidad)<span class="op">/</span><span class="kw">n</span>()<span class="op">*</span><span class="dv">100</span>))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="trabajando-con-el-censo-2010.html#cb229-1"></a><span class="kw">str</span>(datosCalidad)</span></code></pre></div>
<pre><code>## tibble [526 x 2] (S3: tbl_df/tbl/data.frame)
##  $ DPTO         : num [1:526] 2001 2002 2003 2004 2005 ...
##  $ indiceCalidad: num [1:526] 9 2 6 7 5 1 4 10 1 1 ...</code></pre>
<p>Tenemos el porcentaje de viviendas que tienen alguno de estos dos índices como insuficientes. Para esto usamos la función <strong>n()</strong>, que es sumamente útil: nos dice la cantidad de casos que existe para cada grupo. Es especialmente interesante cuando queremos calcular proporciones, ya que al ponerlo en el denominador, solo nos queda poner en el numerador la cantidad de casos que cumplen con nuestro criterio (que lo hicimos con la función <strong>sum()</strong>). Luego multiplicamos por 100, porque así se representan los datos en porcentajes.</p>
<p>Ahora sí, ya podemos hacer la unión con nuestro dataset espacial:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="trabajando-con-el-censo-2010.html#cb231-1"></a>datosCalidad &lt;-<span class="st"> </span><span class="kw">left_join</span>(sfDpto, datosCalidad, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;link&quot;</span>=<span class="st">&quot;DPTO&quot;</span>))</span></code></pre></div>
<p>¡Importante! Vean que pudimos asignar a las observaciones a sus polígonos sin necesidad de hacer un join espacial, como hicimos con los inmuebles y los polígonos de CABA en la anterior clase. Esto se puede hacer siempre que haya un ID que nos permita asignarlo. En general, esto no existe y hay que trabajar con los nombres de las entidades (en este caso, los departamentos).</p>
<p>Antes de seguir, vamos a agregar los nombres de los departamentos, que nos será útil para las visuaizaciones:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="trabajando-con-el-censo-2010.html#cb232-1"></a>datosCalidad&lt;-<span class="st"> </span><span class="kw">left_join</span>(datosCalidad,</span>
<span id="cb232-2"><a href="trabajando-con-el-censo-2010.html#cb232-2"></a>                         departamentos <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(DPTO, NOMDPTO),</span>
<span id="cb232-3"><a href="trabajando-con-el-censo-2010.html#cb232-3"></a>                         <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;link&quot;</span>=<span class="st">&quot;DPTO&quot;</span>)) </span>
<span id="cb232-4"><a href="trabajando-con-el-censo-2010.html#cb232-4"></a><span class="kw">str</span>(datosCalidad)</span></code></pre></div>
<pre><code>## tibble [527 x 4] (S3: sf/tbl_df/tbl/data.frame)
##  $ geometry     :sfc_MULTIPOLYGON of length 527; first list element: List of 1
##   ..$ :List of 1
##   .. ..$ : num [1:539, 1:2] -58.4 -58.4 -58.4 -58.4 -58.4 ...
##   ..- attr(*, &quot;class&quot;)= chr [1:3] &quot;XY&quot; &quot;MULTIPOLYGON&quot; &quot;sfg&quot;
##  $ link         : num [1:527] 2001 2002 2003 2004 6091 ...
##  $ indiceCalidad: num [1:527] 9 2 6 7 25 21 5 1 30 4 ...
##  $ NOMDPTO      : chr [1:527] &quot;Comuna 01&quot; &quot;Comuna 02&quot; &quot;Comuna 03&quot; &quot;Comuna 04&quot; ...
##  - attr(*, &quot;sf_column&quot;)= chr &quot;geometry&quot;
##  - attr(*, &quot;agr&quot;)= Factor w/ 3 levels &quot;constant&quot;,&quot;aggregate&quot;,..: NA NA NA
##   ..- attr(*, &quot;names&quot;)= chr [1:3] &quot;link&quot; &quot;indiceCalidad&quot; &quot;NOMDPTO&quot;</code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mapas.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="haciendo-visualizaciones.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["AnalisisEspacialEnR.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
